
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- This HTML was auto-generated from MATLAB code. To make changes, update the MATLAB code and republish this document.       --><title>半無限プログラミングを使用した不確定性の影響の解析</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="../http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2010-05-27"><meta name="DC.source" content="airpollution.m"><link rel="stylesheet" type="text/css" href="../../../../matlab/demos/private/style.css"></head><body><div class="header"><div class="left"><a href="matlab:edit airpollution">エディターで airpollution.m を開く</a></div><div class="right"><a href="matlab:echodemo airpollution">コマンド ウィンドウで実行</a></div></div><div class="content"><h1>半無限プログラミングを使用した不確定性の影響の解析</h1><!--introduction--><p>このデモでは、最適化問題のモデル パラメーターにおける不確定性の影響を調べるために半無限プログラミングを使用する方法を示します。関数 <tt>fseminf</tt> (Optimization Toolbox™ の半無限プログラミング ソルバー) を使用して、最適化問題を公式化し、解きます。</p><p>このデモでは、大気汚染の制御にかかわる問題を扱います。具体的には、特定の地理的区域に複数の大煙突が建てられます。それぞれの大煙突が高くなると、煙突からの汚染物質の地表濃度が減少します。しかし、それぞれの煙突の建設費は高さに伴って増加します。汚染物質の地表濃度が規制による制限を超えないことを前提に、大煙突の累積的な高さ、すなわち、建設費を最小にするための問題を解いていきます。この問題は、以下の参考文献に記述されています。</p><p>『Air pollution control with semi-infinite programming』A.I.F. Vaz and E.C. Ferreira, XXVIII Congreso Nacional de Estadistica e Investigacion Operativa, October 2004</p><p>このデモでは、最初に、煙突の最小限の高さ<i></i>という問題として上記の論文で発表されている問題を解きます。この問題におけるモデルは、いくつかのパラメーターに依存しますが、そのうちの 2 つは風速と風向です。すべてのモデル パラメーターは、問題の最初の解で正確にわかっているものと仮定します。</p><p>次に、風速と風向のパラメーターを所定の範囲内で変化できるようにすることで、元の問題を拡張します。これにより、この問題の最適解に対する、これらのパラメーター内の不確定性の影響を解析できるようになります。</p><!--/introduction--><h2>目次</h2><div><ul><li><a href="#1">煙突の最小限の高さという問題</a></li><li><a href="#5"><tt>fseminf</tt> の機能</a></li><li><a href="#6">非線形制約関数</a></li><li><a href="#8">最適化問題の解決</a></li><li><a href="#10">最適化結果のチェック</a></li><li><a href="#11">環境要因における不確定性の検討</a></li></ul></div><h2>煙突の最小限の高さという問題<a name="1"></a></h2><p>20km 四方の領域 R に 10 本の大煙突を建設するとします。これらの大煙突から大気中に放出される数種類の汚染物質のうちに、二酸化硫黄が含まれています。煙突の x y 位置は固定されていますが、高さは変わることがあります。</p><p>煙突の建設会社は、煙突の高さの合計、つまり建設費を最小限に抑えたいと考えるでしょう。しかし、このことは、領域 R 内の任意の地点における二酸化硫黄の濃度が規制の最大値を超えてはならないという要件とのトレードオフです。</p><p>まず、初期高さで大煙突をプロットしてみましょう。大煙突が含まれている、R 内の 4km 四方の小領域を拡大していることに注意してください。</p><pre class="codeinput">h0 = [210;210;180;180;150;150;120;120;90;90];
plotChimneyStacks(h0, <span class="string">'Chimney Stack Initial Height'</span>);
</pre><img vspace="5" hspace="5" src="../airpollution_01.png" alt=""> <p>この問題には、環境に関する 2 つのパラメーターがあります。それは、風速と風向です。このデモの後半で、これらのパラメーターを変更できるようにしますが、最初の問題については、これらのパラメーターを標準値に設定します。</p><pre class="codeinput"><span class="comment">% Wind direction in radians</span>
theta0 = 3.996;
<span class="comment">% Wind speed in m/s</span>
U0 = 5.64;
</pre><p>さて、領域 R 全体における二酸化硫黄 (SO2) の地表濃度をプロットします (大煙突のプロットは小領域であったことを思い出してください)。SO2 濃度は、大煙突を初期高さに設定して計算されています。</p><p>SO2 の濃度が関心領域の全体にわたって変化することがわかります。二酸化硫黄グラフには、注目すべき 2 つの特徴があります。</p><div><ul><li>SO2 濃度は、(x,y) 平面の左上隅で高い</li><li>SO2 濃度は、領域の至る所でほぼゼロである</li></ul></div><p>簡潔に言えば、第 1 の特徴の原因は卓越風です。この例では、卓越風によって SO2 が (x,y) 平面の左上に吹き寄せられているのです。第 2 の特徴の原因は、拡散によって SO2 が地面に運ばれていることです。これは卓越風に比べて緩やかな過程であり、SO2 は関心領域の左上隅の地表にのみ到達します。</p><p>大煙突からの大気拡散の詳細は、上記の参考文献を参照してください。</p><p>ピンクの面は、SO2 の濃度 <img src="../airpollution_eq03792.png" alt="$$ 0.000125 gm^{-3} $$"> を示します。これが規制による最大値で、二酸化硫黄は領域 R においてこの値を超えてはなりません。このグラフからはっきりと見て取れるのは、大煙突の初期高さでは、SO2 濃度が最大値を超えるということです。</p><p>MATLAB ファイル <tt>concSulfurDioxide</tt> を調べて、二酸化硫黄濃度の計算方法を確認してください。</p><pre class="codeinput">plotSulfurDioxide(h0, theta0, U0, <span class="keyword">...</span>
    <span class="string">'Sulfur Dioxide Concentration at Initial Stack Height'</span>);
</pre><img vspace="5" hspace="5" src="../airpollution_02.png" alt=""> <h2><tt>fseminf</tt> の機能<a name="5"></a></h2><p>煙突の最小限の高さという問題を解く前に、<tt>fseminf</tt> で半無限問題がどのように解かれるのかを説明します。一般的な半無限プログラミング問題は、以下のように表すことができます。</p><p><img src="../airpollution_eq39038.png" alt="$$\min f(x)$$"></p><p>条件</p><p><img src="../airpollution_eq22027.png" alt="$$Ax &lt;= b $$"> (線形不等式制約)</p><p><img src="../airpollution_eq92853.png" alt="$$Aeq*x = beq $$"> (線形等式制約)</p><p><img src="../airpollution_eq67964.png" alt="$$c(x) &lt;= 0 $$"> (非線形不等式制約)</p><p><img src="../airpollution_eq53562.png" alt="$$ceq(x) = 0 $$"> (非線形等式制約)</p><p><img src="../airpollution_eq20264.png" alt="$$l &lt;= x &lt;= u $$"> (範囲)</p><p>および</p><p><img src="../airpollution_eq04491.png" alt="$$K_{j}(x, w) &lt;= 0 $$">、このとき <img src="../airpollution_eq10651.png" alt="$$w \in I_{j} $$">、<img src="../airpollution_eq74084.png" alt="$$j = 1,..., n_{inf} $$"> (非線形半無限制約)</p><p>このアルゴリズムでは、補助変数 <img src="../airpollution_eq60975.png" alt="$$ w $$"> の区間で満たす必要のある、非線形最適化問題の制約を指定できます。<tt>fseminf</tt> では、この変数は各半無限制約について 1 次元または 2 次元のいずれかに限定されることに注意してください。</p><p>関数 <tt>fseminf</tt> は、初期値 <img src="../airpollution_eq11539.png" alt="$$ x_{0} $$"> を取り、最適解 <img src="../airpollution_eq75145.png" alt="$$ x_{opt} $$"> を求めるために反復計算を行うことによって、一般的な半無限問題を解きます。</p><p>このアルゴリズムで重要なのは、「半無限」制約 <img src="../airpollution_eq13544.png" alt="$$ K_{j} $$"> の取り扱いです。<img src="../airpollution_eq75145.png" alt="$$ x_{opt} $$"> では、<img src="../airpollution_eq13544.png" alt="$$ K_{j} $$"> が区間 <img src="../airpollution_eq89727.png" alt="$$ I_{j} $$"> のあらゆる <img src="../airpollution_eq60975.png" alt="$$ w $$"> の値で可解でなければなりません。この制約は、区間 <img src="../airpollution_eq89727.png" alt="$$ I_{j} $$"> で、<img src="../airpollution_eq60975.png" alt="$$ w $$"> についての <img src="../airpollution_eq13544.png" alt="$$ K_{j} $$"> のすべての極大値を考慮することで簡素化できます。元の制約は、上記のそれぞれの極大値で <img src="../airpollution_eq13544.png" alt="$$ K_{j} $$"> が可解でなければならないという条件に等しくなります。</p><p>関数 <tt>fseminf</tt> は、それぞれの半無限制約 <img src="../airpollution_eq13544.png" alt="$$ K_{j} $$"> のすべての極大値の近似値を求めます。このためには、<tt></tt>まず、<img src="../airpollution_eq60975.png" alt="$$ w $$"> 値のメッシュでのそれぞれの半無限制約を計算します。次に、求められた半無限制約から <img src="../airpollution_eq13544.png" alt="$$ K_{j} $$"> のすべての極大値を計算するために、単純な差分法を使用します。</p><p>後で確認するように、このメッシュを制約関数で作成します。メッシュの各 <img src="../airpollution_eq60975.png" alt="$$ w $$"> 座標の間隔は、関数 <tt>fseminf</tt> によって制約関数に与えられます。</p><p>このアルゴリズムの各反復において、以下の手順が実行されます。</p><div><ol><li>各 <img src="../airpollution_eq60975.png" alt="$$ w $$"> 座標の現在のメッシュの間隔を使用して、<img src="../airpollution_eq60975.png" alt="$$ w $$"> 値のメッシュの <img src="../airpollution_eq13544.png" alt="$$ K_{j} $$"> を求めます。</li><li>手順 1 で求めた <img src="../airpollution_eq13544.png" alt="$$ K_{j} $$"> を使用して、<img src="../airpollution_eq13544.png" alt="$$ K_{j} $$"> のすべての極大値の近似値を計算します。</li><li>一般的な半無限問題にある各 <img src="../airpollution_eq13544.png" alt="$$ K_{j} $$"> を、上の手順 1 ～ 2 で求めた極大値に置き換えます。これで、問題が有限個の非線形制約を持つことになります。<tt>fseminf</tt> は、<tt>fmincon</tt> で使用される SQP アルゴリズムを使用して、変更された問題の反復計算を 1 回実行します。</li><li>新しい点 <img src="../airpollution_eq04575.png" alt="$$ x $$"> で、SQP アルゴリズムの停止条件が満たされたかどうかを確認します。いずれかの基準が満たされている場合、アルゴリズムが終了します。そうでない場合、<tt>fseminf</tt> の処理が手順 5 に進みます。たとえば、手順 3 で定義された問題の 1 次の最適性の値が、指定された許容値を下回る場合、<tt>fseminf</tt> は終了します。</li><li>手順 1 における半無限制約の評価で使用されたメッシュ間隔を更新します。</li></ol></div><h2>非線形制約関数の記述<a name="6"></a></h2><p><tt>fseminf</tt> を呼び出して問題を解く前に、この問題における非線形制約を評価するための関数を記述しなければなりません。ここで指定する制約は、R のどの場所でも地表の SO2 濃度が <img src="../airpollution_eq03792.png" alt="$$ 0.000125 gm^{-3} $$"> を超えてはならないということです。</p><p>これは半無限制約です。ここでは、この制約関数の実装について説明します。煙突の最小限の高さという問題に関しては、MATLAB ファイル <tt>airPollutionCon</tt> で制約を実装しています。</p><pre class="codeinput">type <span class="string">airPollutionCon.m</span>
</pre><pre class="codeoutput">
function [c, ceq, K, s] = airPollutionCon(h, s, theta, U)
%AIRPOLLUTIONCON Constraint function for air pollution demo
% 
%   [C, CEQ, K, S] = AIRPOLLUTIONCON(H, S, THETA, U) calculates the
%   constraints for the air pollution Optimization Toolbox (TM) demo.This
%   function first creates a grid of (X, Y) points using the supplied grid
%   spacing, S. The following constraint is then calculated over each point
%   of the grid:
%
%   Sulfur Dioxide concentration at the specified wind direction, THETA and
%   wind speed U &lt;= 1.25e-4 g/m^3
%
%   See also AIRPOLLUTION

%   Copyright 2008 The MathWorks, Inc.
%   $Revision: 1.1.4.12.2.1 $  $Date: 2010/07/29 21:28:56 $

% Initial sampling interval
if nargin &lt; 2 || isnan(s(1,1))
    s = [1000 4000]; 
end

% Define the grid that the &quot;infinite&quot; constraints will be evaluated over
w1x = -20000:s(1,1):20000;
w1y = -20000:s(1,2):20000;
[t1,t2] = meshgrid(w1x,w1y);

% Maximum allowed sulphur dioxide
maxsul = 1.25e-4; 

% Calculate the constraint over the grid
K = concSulfurDioxide(t1, t2, h, theta, U) - maxsul;

% Rescale constraint to make it 0(1)
K = 1e4*K;

% No finite constraints
c = [];
ceq = [];
</pre><p>この関数は、半無限プログラミング問題に対する制約関数の一般的な構造を示しています。特に、<tt>fseminf</tt> の制約関数は以下の 3 つの部分に分けることができます。</p><p>1. 制約評価のための初期メッシュ サイズの定義</p><p><tt>fseminf</tt> は、これらの制約の計算全体の一部としてメッシュ全体にわたって &quot;半無限&quot; 制約を評価する、ということを思い出してください。制約関数が <tt>fseminf</tt> から呼び出されると、使用すべきメッシュ間隔が関数に与えられます。<tt>fseminf</tt> は最初に、メッシュ間隔 <tt>s</tt> を NaN に設定して、制約関数を呼び出します。これにより、制約評価のためのメッシュ サイズを初期化できます。ここで、2 つの &quot;無限&quot; 変数に 1 つの &quot;無限&quot; 制約があります。これは、メッシュ サイズを 1 行 2 列の行列 (この場合は <tt>s = [1000 4000]</tt>) に初期化しなければならないことを意味しています。</p><p>2. 制約評価で使用するメッシュの定義</p><p>制約評価で使用するメッシュを作成しなければなりません。<tt>airPollutionCon</tt> 内の &quot;Define the grid that the &quot;infinite&quot; constraints will be evaluated over&quot; というコメントに続く 3 行のコードを、ほとんどの 2 次元半無限プログラミング問題で変更することができます。</p><p>3. メッシュ全体の制約の計算</p><p>メッシュを定義したら、そのメッシュ全体の制約を計算できます。次に、これらの制約が上記の制約関数から <tt>fseminf</tt> に返されます。</p><p>この問題では、目的関数のスケールに近いスケールで制約が変化するように、制約の再スケールも行っています。これにより、さまざまなスケールで変化する目的と制約に関するスケーリング問題を <tt>fseminf</tt> で回避しやすくなります。</p><h2>最適化問題の解決<a name="8"></a></h2><p><tt>fseminf</tt> を呼び出して、問題を解きます。大煙突はすべて 10m 以上でなければならないため、以前に指定した煙突の初期高さを使用します。以下の <tt>fseminf</tt> の 3 番目の引数 (1) は、半無限制約が 1 つのみ存在することを示しています。</p><pre class="codeinput">lb = 10*ones(size(h0));
[hsopt, sumh, exitflag] = fseminf(@(h)sum(h), h0, 1, <span class="keyword">...</span>
    @(h,s) airPollutionCon(h,s,theta0,U0), [], [], [], [], lb);
fprintf(<span class="string">'\nMinimum computed cumulative height of chimney stacks : %7.2f m\n'</span>, sumh);
</pre><pre class="codeoutput">
Local minimum possible.Constraints satisfied.

fseminf stopped because the predicted change in the objective function
is less than the default value of the function tolerance and constraints 
were satisfied to within the default value of the constraint tolerance.




Minimum computed cumulative height of chimney stacks :3667.19 m
</pre><p><tt>fseminf</tt> によって計算される最小累積高さは、大煙突の初期合計高さを大幅に上回っています。このデモの後半でパラメーターの不確定性が問題に追加されるときに、最小累積高さがどのように変化するのかを確認します。まず、最適な高さで大煙突をプロットしてみましょう。</p><p>MATLAB ファイル <tt>plotChimneyStacks</tt> を調べて、プロットの生成方法を確認します。</p><pre class="codeinput">plotChimneyStacks(hsopt, <span class="string">'Chimney Stack Optimal Height'</span>);
</pre><img vspace="5" hspace="5" src="../airpollution_03.png" alt=""> <h2>最適化結果のチェック<a name="10"></a></h2><p><tt>fseminf</tt> によって、制約の離散化された極大値が指定の境界を下回ることを保証することで、半無限制約がどこでも満足されると判断されることを思い出してください。煙突の高さが最適な場合の二酸化硫黄の地表濃度をプロットすることで、半無限制約がどこでも満足されることを確認できます。</p><p>二酸化硫黄濃度の値が最も高くなるのは、(x, y) 平面の左上隅、すなわち x = -20000m および y = 20000m です。下図で青い点で示したこのポイントは、そこにおける二酸化硫黄濃度を計算することで検証されています。</p><p>MATLAB ファイル <tt>plotSulfurDioxide</tt> を調べて、プロットの生成方法を確認します。</p><pre class="codeinput">titleStr = <span class="string">'Optimal Sulfur Dioxide Concentration and its maximum (blue)'</span>;
xMaxSD = [-20000 20000];
plotSulfurDioxide(hsopt, theta0, U0, titleStr, xMaxSD);
SO2Max = concSulfurDioxide(-20000, 20000, hsopt, theta0, U0);
fprintf(<span class="string">'Sulfur Dioxide Concentration at x = -20000m, y = 20000m :%e g/m^3\n'</span>, SO2Max);
</pre><pre class="codeoutput">Sulfur Dioxide Concentration at x = -20000m, y = 20000m :1.250000e-004 g/m^3
</pre><img vspace="5" hspace="5" src="../airpollution_04.png" alt=""> <h2>環境要因における不確定性の検討<a name="11"></a></h2><p>二酸化硫黄濃度は、いくつかの環境要因に左右されます。これらの要因は、上記の問題において固定値で保持されています。そのうちの 2 つが風速と風向です。すべての問題パラメーターの詳細は、上記の参考文献を参照してください。</p><p>風速と風向に関してシステムの動作の変化を調べることができます。デモのこの部分では、風向が 3.82 rad から 4.18 rad に変化し、平均風速が 5 ～ 6.2 m/s の範囲で変動する場合でも、二酸化硫黄限度が満たされることを確認します。</p><p>領域 R において二酸化硫黄濃度が上限を超えないことを保証するために、半無限制約を実装する必要があります。この制約は、風速と風向のすべての組み合わせについて可解でなければなりません。</p><p>このような制約は、4 つの &quot;無限&quot; 変数 (風速、風向、地表の x-y 座標) を持つことになります。しかし、<tt>fseminf</tt> に提供される半無限制約が持つことができる &quot;無限&quot; 変数は 2 つのみです。</p><p><tt>fseminf</tt> にとって適切な形でこの制約を実装するには、以前の問題における煙突の最適な高さでの SO2 濃度を思い出す必要があります。特に、SO2 濃度の値が最も高くなるのは、x = -20000m および y = 20000m です。&quot;無限&quot; 変数の数を減らすために、不確定性が存在する場合にも SO2 濃度の値がこのポイントで最も高くなると仮定します。さらに、この点の SO2 濃度は、風速と風向のどのような組み合わせでも <img src="../airpollution_eq03792.png" alt="$$ 0.000125 gm^{-3} $$"> を下回らなければなりません。</p><p>これは、この問題の &quot;無限&quot; 変数が風速と風向であることを意味します。この制約がどのように実装されているのかを確認するために、MATLAB ファイル <tt>uncertainAirPollutionCon</tt> を調べます。</p><pre class="codeinput">type <span class="string">uncertainAirPollutionCon.m</span>
</pre><pre class="codeoutput">
function [c, ceq, K, s] = uncertainAirPollutionCon(h, s)
%UNCERTAINAIRPOLLUTIONCON Constraint function for air pollution demo
% 
%   [C, CEQ, K, S] = UNCERTAINAIRPOLLUTIONCON(H, S) calculates the
%   constraints for the fseminf Optimization Toolbox (TM) demo.This
%   function first creates a grid of wind speed/direction points using the
%   supplied grid spacing, S. The following constraint is then calculated
%   over each point of the grid:
%
%   Sulfur Dioxide concentration at x = -20000m, y = 20000m &lt;= 1.25e-4
%   g/m^3
%
%   See also AIRPOLLUTIONCON, AIRPOLLUTION

%   Copyright 2008 The MathWorks, Inc.
%   $Revision: 1.1.4.12.2.1 $  $Date: 2010/07/29 21:28:56 $

% Maximum allowed sulphur dioxide
maxsul = 1.25e-4; 

% Initial sampling interval
if nargin &lt; 2 || isnan(s(1,1))
    s = [0.02 0.04]; 
end

% Define the grid that the &quot;infinite&quot; constraints will be evaluated over
w1x = 3.82:s(1,1):4.18; % Wind direction
w1y = 5.0:s(1,2):6.2;   % Wind speed
[t1,t2] = meshgrid(w1x,w1y);

% We assume the maximum SO2 concentration is at [x, y] = [-20000, 20000]
% for all wind speed/direction pairs.We evaluate the SO2 constraint over
% the [theta, U] grid at this point.
K = concSulfurDioxide(-20000, 20000, h, t1, t2) - maxsul;
 
% Rescale constraint to make it 0(1)
K = 1e4*K;

% No finite constraints
c = [];
ceq = [];


</pre><p>この制約関数は、上記と同じ 3 つの部分に分けることができます。</p><p>1. 制約評価のための初期メッシュ サイズの定義</p><p>&quot;Initial sampling interval&quot; というコメントに続くコードで、メッシュ サイズを初期化します。</p><p>2. 制約評価で使用するメッシュの定義</p><p>次のコード部分では、最初の問題で使用したものと同様の構成を使用してメッシュ (ここでは風速と風向) を作成します。</p><p>3. メッシュ全体の制約の計算</p><p>コードの残りの部分では、風速/風向メッシュの各ポイントにおける SO2 濃度を計算します。次に、これらの制約が上記の制約関数から <tt>fseminf</tt> に返されます。</p><p>ここで、環境要因における不確定性を考慮した煙突高さ問題を解くために、<tt>fseminf</tt> を呼び出すことができます。</p><pre class="codeinput">[hsopt2, sumh2, exitflag2] = fseminf(@(h)sum(h), h0, 1, <span class="keyword">...</span>
    @uncertainAirPollutionCon, [], [], [], [], lb);
fprintf(<span class="string">'\nMinimal computed cumulative height of chimney stacks with uncertainty:%7.2f m\n'</span>, sumh2);
</pre><pre class="codeoutput">
Local minimum possible.Constraints satisfied.

fseminf stopped because the predicted change in the objective function
is less than the default value of the function tolerance and constraints 
were satisfied to within the default value of the constraint tolerance.




Minimal computed cumulative height of chimney stacks with uncertainty:3812.70 m
</pre><p>パラメーターの不確定性がある場合とない場合で、計算された煙突の最小累積高さがどの程度異なるかを確認できます。不確定性が問題に追加された場合に最小累積高さが増すことを確認できるはずです。予想されるこの高さの増加によって、指定範囲内の風速/風向のすべての組み合わせについて SO2 濃度が規制の最大値を下回ることができます。</p><p>二酸化硫黄のプロットを調べることで、関心領域全体において二酸化硫黄濃度がこの上限を超えないことをチェックできます。所定の (x, y) ポイントで、指定範囲内の風速と風向について SO2 の最大濃度をプロットします。X-Y 平面の左上隅を拡大していることに注意してください。</p><pre class="codeinput">titleStr = <span class="string">'Optimal Sulfur Dioxide Concentration under Uncertainty'</span>;
thetaRange = 3.82:0.02:4.18;
URange = 5:0.2:6.2;
XRange = [-20000,-15000];
YRange = [15000,20000];
plotSulfurDioxideUncertain(hsopt2, thetaRange, URange, XRange, YRange, titleStr);
</pre><img vspace="5" hspace="5" src="../airpollution_05.png" alt=""> <p>最後に、問題定義に不確定性が存在する場合の最適な高さにおける大煙突をプロットします。</p><pre class="codeinput">plotChimneyStacks(hsopt2, <span class="string">'Chimney Stack Optimal Height under Uncertainty'</span>);
</pre><img vspace="5" hspace="5" src="../airpollution_06.png" alt=""> <p>半無限プログラミング アルゴリズム <tt>fseminf</tt> では、多数のオプションを使用できます。詳細は、『Optimization Toolbox™ ユーザー ガイド』の章「Optimization Toolbox ソルバーの使用」の「制約付き非線形最適化: fseminf 問題の定式化とアルゴリズム」を参照してください。</p><p class="footer">Copyright 2008-2010 The MathWorks, Inc.<br>Published with MATLAB&reg; 7.11</p><p class="footer" id="trademarks">MATLAB and Simulink are registered trademarks of The MathWorks, Inc.  Please see <a href="http://www.mathworks.com/trademarks">www.mathworks.com/trademarks</a> for a list of other trademarks owned by The MathWorks, Inc.  Other product or brand names are trademarks or registered trademarks of their respective owners.</p></div><!-- ##### SOURCE BEGIN ##### %% Analyzing the Effect of Uncertainty Using Semi-Infinite Programming %  % This demo illustrates how to use semi-infinite programming to investigate % the effect of uncertainty in the model parameters of an optimization % problem. We will formulate and solve an optimization problem using the % function |fseminf|, a semi-infinite programming solver in the % Optimization Toolbox(TM). %  % The problem illustrated in this demo involves the control of air % pollution. Specifically, a set of chimney stacks are to be built in a % given geographic area. As the height of each chimney stack increases, the % ground level concentration of pollutants from the stack decreases. % However, the construction cost of each chimney stack increases with % height. We will solve a problem to minimize the cumulative height of the % chimney stacks, hence construction cost, subject to ground level % pollution concentration not exceeding a legislated limit. This problem is % outlined in the following reference: %  % Air pollution control with semi-infinite programming, A.I.F. Vaz and E.C. % Ferreira, XXVIII Congreso Nacional de Estadistica e Investigacion % Operativa, October 2004 % % In this demo we will first solve the problem published in the above % article as the _Minimal Stack Height_ problem. The models in this problem % are dependent on several parameters, two of which are wind speed and % direction. All model parameters are assumed to be known exactly in the % first solution of the problem. % % We then extend the original problem by allowing the wind speed and % direction parameters to vary within given ranges. This will allow us to % analyze the effects of uncertainty in these parameters on the optimal % solution to this problem.  %   Copyright 2008-2010 The MathWorks, Inc. %   $Revision: 1.1.4.12.2.1 $  $Date: 2010/07/29 21:28:56 $  %% Minimal Stack Height Problem % Consider a 20km-by-20km region, R, in which ten chimney stacks are to be % placed. These chimney stacks release several pollutants into the % atmosphere, one of which is sulfur dioxide. The x, y locations of the % stacks are fixed, but the height of the stacks can vary.  % % Constructors of the stacks would like to minimize the total height of the % stacks, thus minimizing construction costs. However, this is balanced by % the conflicting requirement that the concentration of sulfur dioxide at % any point on the ground in the region R must not exceed the legislated % maximum.  %% % First, let's plot the chimney stacks at their initial height. Note that % we have zoomed in on a 4km-by-4km subregion of R which contains the % chimney stacks. h0 = [210;210;180;180;150;150;120;120;90;90]; plotChimneyStacks(h0, 'Chimney Stack Initial Height');  %% % There are two environment related parameters in this problem, the wind % speed and direction. Later in this demo we will allow these parameters to % vary, but for the first problem we will set these parameters to typical % values.  % Wind direction in radians theta0 = 3.996;    % Wind speed in m/s U0 = 5.64;      %% % Now let's plot the ground level concentration of sulfur dioxide (SO2) % over the entire region R (remember that the plot of chimney stacks was % over a smaller region). The SO2 concentration has been calculated with % the chimney stacks set to their initial heights.  % % We can see that the concentration of SO2 varies over the region of % interest. There are two features of the Sulfur Dioxide graph of note: %  % * SO2 concentration rises in the top left hand corner of the (x,y) plane % * SO2 concentration is approximately zero throughout most of the region %  % In very simple terms, the first feature is due to the prevailing wind, % which is blowing SO2 toward the top left hand corner of the (x,y) plane % in this example. The second factor is due to SO2 being transported to the % ground via diffusion. This is a slower process compared to the prevailing % wind and thus SO2 only reaches ground level in the top left hand corner % of the region of interest. % % For a more detailed discussion of atmospheric dispersion from chimney % stacks, consult the reference cited in the introduction. % % The pink plane indicates a SO2 concentration of $$ 0.000125 gm^{-3} $$. % This is the legislated maximum for which the Sulfur Dioxide concentration % must not exceed in the region R. It can be clearly seen from the graph % that the SO2 concentration exceeds the maximum for the initial chimney % stack height.  % % Examine the MATLAB file |concSulfurDioxide| to see how the sulfur dioxide % concentration is calculated.  plotSulfurDioxide(h0, theta0, U0, ...     'Sulfur Dioxide Concentration at Initial Stack Height');  %% How |fseminf| Works % % Before we solve the minimal stack height problem, we will outline how % |fseminf| solves a semi-infinite problem. A general semi-infinite % programming problem can be stated as: % % $$\min f(x)$$ % % such that  %  % $$Ax <= b $$ (Linear inequality constraints) % % $$Aeq*x = beq $$ (Linear equality constraints) % % $$c(x) <= 0 $$ (Nonlinear Inequality Constraints) % % $$ceq(x) = 0 $$ (Nonlinear Equality Constraints) % % $$l <= x <= u $$ (Bounds) % % and  % % $$K_{j}(x, w) <= 0 $$, where $$w \in I_{j} $$ for $$j = 1,..., n_{inf} $$ % (Nonlinear semi-infinite constraints) % % This algorithm allows you to specify constraints for a nonlinear % optimization problem that must be satisfied over intervals of an % auxiliary variable, $$ w $$. Note that for |fseminf|, this variable is % restricted to be either 1 or 2 dimensional for each semi-infinite % constraint. % % The function |fseminf| solves the general semi-infinite problem by % starting from an initial value, $$ x_{0} $$, and using an iterative % procedure to obtain an optimum solution, $$ x_{opt} $$.  %  % The key component of the algorithm is the handling of the "semi-infinite" % constraints, $$ K_{j} $$. At $$ x_{opt} $$ it is required that the $$ % K_{j} $$ must be feasible at every value of $$ w $$ in the interval $$ % I_{j} $$. This constraint can be simplified by considering all the local  % maxima of $$ K_{j} $$ with respect to $$ w $$ in the interval $$ I_{j} % $$. The original constraint is equivalent to requiring that the value of % $$ K_{j} $$ at each of the above local maxima is feasible. % % |fseminf| calculates an approximation to all the local maximum values of % each semi-infinite constraint, $$ K_{j} $$. To do this, |fseminf| first % calculates each semi-infinite constraint over a mesh of $$ w $$ values. A % simple differencing scheme is then used to calculate all the local % maximum values of $$ K_{j} $$ from the evaluated semi-infinite % constraint. % % As we will see later, you create this mesh in your constraint function. % The spacing you should use for each $$ w $$ coordinate of the mesh is % supplied to your constraint function by |fseminf|. % % At each iteration of the algorithm, the following steps are performed: %  % # Evaluate $$ K_{j} $$ over a mesh of $$ w $$-values using the current % mesh spacing for each $$ w $$-coordinate. % # Calculate an approximation to all the local maximum values of $$ K_{j} % $$ using the evaluation of $$ K_{j} $$ from step 1. % # Replace each $$ K_{j} $$ in the general semi-infinite problem with the % set of local maximum values found in steps 1-2. The problem now has a % finite number of nonlinear constraints. |fseminf| uses the SQP algorithm % used by |fmincon| to take one iteration step of the modified problem. % # Check if any of the SQP algorithm's stopping criteria are met at the % new point $$ x $$. If any criteria are met the algorithm terminates; if % not, |fseminf| continues to step 5. For example, if the first order % optimality value for the problem defined in step 3 is less than the % specified tolerance then |fseminf| will terminate. % # Update the mesh spacing used in the evaluation of the semi-infinite % constraints in step 1.  %% Writing the Nonlinear Constraint Function % % Before we can call |fseminf| to solve the problem, we need to write a % function to evaluate the nonlinear constraints in this problem. The % constraint to be implemented is that the ground level Sulfur Dioxide % concentration must not exceed $$ 0.000125 gm^{-3} $$ at every point in % region R. % % This is a semi-infinite constraint, and the implementation of the % constraint function is explained in this section. For the minimal stack % height problem we have implemented the constraint in the MATLAB file % |airPollutionCon|.  type airPollutionCon.m  %% % This function illustrates the general structure of a constraint function % for a semi-infinite programming problem. In particular, a constraint % function for |fseminf| can be broken up into three parts: %  % 1. Define the initial mesh size for the constraint evaluation % % Recall that |fseminf| evaluates the "semi-infinite" constraints over a % mesh as part of the overall calculation of these constraints. When your % constraint function is called by |fseminf|, the mesh spacing you should % use is supplied to your function. |Fseminf| will initially call your % constraint function with the mesh spacing, |s|, set to NaN. This % allows you to initialize the mesh size for the constraint evaluation. % Here, we have one "infinite" constraint in two "infinite" variables. This % means we need to initialize the mesh size to a 1-by-2 matrix, in this % case, |s = [1000 4000]|. % % 2. Define the mesh that will be used for the constraint evaluation % % A mesh that will be used for the constraint evaluation needs to be % created. The three lines of code following the comment "Define the grid % that the "infinite" constraints will be evaluated over" in % |airPollutionCon| can be modified for most 2-d semi-infinite programming % problems. % % 3. Calculate the constraints over the mesh % % Once the mesh has been defined, the constraints can be calculated over % it. These constraints are then returned to |fseminf| from the above % constraint function. % % Note that in this problem, we have also rescaled the constraints so that % they vary on a scale which is closer to that of the objective function. % This helps |fseminf| to avoid scaling issues associated with objectives % and constraints which vary on disparate scales.  %% Solve the Optimization Problem % % We can now call |fseminf| to solve the problem. The chimney stacks must % all be at least 10m tall and we use the initial stack height specified % earlier. Note that the third input argument to |fseminf| below (1) % indicates that there is only one semi-infinite constraint.  lb = 10*ones(size(h0)); [hsopt, sumh, exitflag] = fseminf(@(h)sum(h), h0, 1, ...     @(h,s) airPollutionCon(h,s,theta0,U0), [], [], [], [], lb); fprintf('\nMinimum computed cumulative height of chimney stacks : %7.2f m\n', sumh);  %%  % The minimum cumulative height computed by |fseminf| is considerably % higher than the initial total height of the chimney stacks. We will see % how the minimum cumulative height changes when parameter uncertainty is % added to the problem later in the demo. For now, let's plot the chimney % stacks at their optimal height. % % Examine the MATLAB file |plotChimneyStacks| to see how the plot was generated.  plotChimneyStacks(hsopt, 'Chimney Stack Optimal Height');  %% Check the Optimization Results % % Recall that |fseminf| determines that the semi-infinite constraint is % satisfied everywhere by ensuring that discretized maxima of the % constraint are below the specified bound. We can verify that the % semi-infinite constraint is satisfied everywhere by plotting the ground % level sulfur dioxide concentration for the optimal stack height. % % Note that the sulfur dioxide concentration takes its maximum possible % value in the upper left corner of the (x, y) plane, i.e. at x = -20000m, % y = 20000m. This point is marked by the blue dot in the figure below and % verified by calculating the sulfur dioxide concentration at this point. % % Examine the MATLAB file |plotSulfurDioxide| to see how the plots was % generated.  titleStr = 'Optimal Sulfur Dioxide Concentration and its maximum (blue)'; xMaxSD = [-20000 20000]; plotSulfurDioxide(hsopt, theta0, U0, titleStr, xMaxSD); SO2Max = concSulfurDioxide(-20000, 20000, hsopt, theta0, U0); fprintf('Sulfur Dioxide Concentration at x = -20000m, y = 20000m : %e g/m^3\n', SO2Max);    %% Considering Uncertainty in the Environmental Factors % The sulfur dioxide concentration depends on several environmental factors % which were held at fixed values in the above problem. Two of the % environmental factors are wind speed and wind direction. See the % reference cited in the introduction for a more detailed discussion of all % the problem parameters. % % We can investigate the change in behavior for the system with respect to % the wind speed and direction. In this section of the demo, we want to % make sure that the sulfur dioxide limits are satisfied even if the wind % direction changes from 3.82 rad to 4.18 rad and mean wind speed varies % between 5 and 6.2 m/s.  %% % We need to implement a semi-infinite constraint to ensure that the sulfur % dioxide concentration does not exceed the limit in region R. This % constraint is required to be feasible for all pairs of wind speed and % direction. %  % Such a constraint will have four "infinite" variables (wind speed and % direction and the x-y coordinates of the ground). However, any % semi-infinite constraint supplied to |fseminf| can have no more than two % "infinite" variables. % % To implement this constraint in a suitable form for |fseminf|, we recall % the SO2 concentration at the optimum stack height in the previous % problem. In particular, the SO2 concentration takes its maximum possible % value at x = -20000m, y = 20000m. To reduce the number of "infinite" % variables, we will assume that the SO2 concentration will also take its % maximum value at this point when uncertainty is present. We then require % that SO2 concentration at this point is below $$ 0.000125 gm^{-3} $$ for % all pairs of wind speed and direction. % % This means that the "infinite" variables for this problem are wind speed % and direction. To see how this constraint has been implemented, inspect % the MATLAB file |uncertainAirPollutionCon|.  type uncertainAirPollutionCon.m  %%  % This constraint function can be divided into same three sections as % before: % % 1. Define the initial mesh size for the constraint evaluation % % The code following the comment "Initial sampling interval" initializes % the mesh size. % % 2. Define the mesh that will be used for the constraint evaluation % % The next section of code creates a mesh (now in wind speed and direction) % using a similar construction to that used in the initial problem. % % 3. Calculate the constraints over the mesh %  % The remainder of the code calculates the SO2 concentration at each point % of the wind speed/direction mesh. These constraints are then returned to % |fseminf| from the above constraint function.  %% % We can now call |fseminf| to solve the stack height problem considering % uncertainty in the environmental factors.   [hsopt2, sumh2, exitflag2] = fseminf(@(h)sum(h), h0, 1, ...     @uncertainAirPollutionCon, [], [], [], [], lb); fprintf('\nMinimal computed cumulative height of chimney stacks with uncertainty: %7.2f m\n', sumh2);  %% % We can now look at the difference between the minimum computed cumulative % stack height for the problem with and without parameter uncertainty. You % should be able to see that the minimum cumulative height increases when % uncertainty is added to the problem. This expected increase in height % allows the SO2 concentration to remain below the legislated maximum for % all wind speed/direction pairs in the specified range. % % We can check that the sulfur dioxide concentration does not exceed the % limit over the region of interest via inspection of a sulfur dioxide % plot. For a given (x, y) point, we plot the maximum SO2 % concentration for the wind speed and direction in the stated ranges. Note % that we have zoomed in on the upper left corner of the X-Y plane. titleStr = 'Optimal Sulfur Dioxide Concentration under Uncertainty'; thetaRange = 3.82:0.02:4.18; URange = 5:0.2:6.2; XRange = [-20000,-15000]; YRange = [15000,20000]; plotSulfurDioxideUncertain(hsopt2, thetaRange, URange, XRange, YRange, titleStr);  %%  % We finally plot the chimney stacks at their optimal height when there is  % uncertainty in the problem definition.  plotChimneyStacks(hsopt2, 'Chimney Stack Optimal Height under Uncertainty');  %%  % There are many options available for the semi-infinite programming % algorithm, |fseminf|. Consult the Optimization Toolbox(TM) User's Guide % for details, in the Using Optimization Toolbox Solvers chapter, under % Constrained Nonlinear Optimization: fseminf Problem Formulation and % Algorithm.  displayEndOfDemoMessage(mfilename)  ##### SOURCE END ##### --></body></html>